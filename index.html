<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åœ¨æ·¡æ°´ï¼Œç·´ç¿’å’Œä½ ä¸€èµ·ç”Ÿæ´» ğŸŒ…</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700&display=swap');
        :root { --bg-color: #FDF6E3; --primary-color: #E58E58; --secondary-color: #5F8575; --text-color: #433431; }
        body { font-family: 'Noto Sans TC', sans-serif; background-color: var(--bg-color); color: var(--text-color); }
        .card { background: rgba(255, 255, 255, 0.98); backdrop-filter: blur(12px); }
        .btn-option { transition: all 0.2s; border: 2px solid #F1ECE1; }
        .btn-option:hover { border-color: var(--primary-color); background-color: #FFF9F2; }
        .btn-primary { background-color: var(--primary-color); color: white; }
        .progress-inner { height: 100%; background: var(--secondary-color); transition: width 0.3s; }
    </style>
</head>
<body class="min-h-screen flex items-center justify-center p-4">

    <div id="app" class="max-w-md w-full card rounded-[2.5rem] shadow-2xl p-8 border-t-8 border-[#E58E58]">
        
        <div id="start-screen" class="text-center">
            <div class="text-5xl mb-6">ğŸŒ…</div>
            <h1 class="text-2xl font-bold mb-1 tracking-wider">åœ¨æ·¡æ°´ï¼Œç·´ç¿’å’Œä½ ä¸€èµ·ç”Ÿæ´»</h1>
            <h2 class="text-[10px] text-[#5F8575] font-bold mb-8 uppercase tracking-[0.2em]">Our Cohabitation Manifesto</h2>
            <div class="bg-[#F8F3E9] p-5 rounded-2xl border border-[#EEE] text-left text-xs text-gray-500 leading-relaxed mb-8">
                é€™æ˜¯ä¸€å ´æº«æŸ”çš„å°é½Šç·´ç¿’ã€‚é™¤äº†é¸æ“‡é¡Œï¼Œå¦³ä¹Ÿå¯ä»¥åœ¨ç©ºæ ¼è™•å¡«å¯«å¿ƒè£¡çš„çœŸå¯¦æƒ³æ³•ã€‚å®Œæˆå¾Œæˆªåœ–æˆ–å„²å­˜ï¼Œä½œç‚ºæˆ‘å€‘æœªä¾†è¨è«–çš„å‚™å¿˜éŒ„ã€‚
            </div>
            <button onclick="startQuiz()" class="w-full py-4 rounded-2xl btn-primary font-bold text-lg shadow-lg">é–‹å§‹å°é½Šè¨ˆç•«</button>
        </div>

        <div id="quiz-screen" class="hidden">
            <div class="mb-6 text-center">
                <div id="progress-text" class="text-[10px] font-bold text-gray-400 mb-2 uppercase">QUESTION 1</div>
                <div class="h-1 w-full bg-gray-100 rounded-full overflow-hidden">
                    <div id="progress-inner" class="progress-inner" style="width: 10%"></div>
                </div>
            </div>
            <h2 id="question-text" class="text-lg font-bold mb-8 text-center leading-snug text-gray-800">é¡Œç›®è¼‰å…¥ä¸­...</h2>
            
            <div id="options" class="space-y-3"></div>
            
            <div id="custom-input-area" class="mt-4 hidden">
                <input id="custom-text" type="text" placeholder="è¼¸å…¥å¦³çš„æƒ³æ³•..." class="w-full p-4 border-2 border-dashed border-gray-200 rounded-xl text-sm focus:border-[#E58E58] outline-none">
                <button onclick="handleCustomSubmit()" class="w-full mt-3 py-3 bg-[#5F8575] text-white rounded-xl font-bold text-sm">ç¢ºèªé€™é¡Œ</button>
            </div>
        </div>

        <div id="share-screen" class="hidden text-center">
            <div class="text-5xl mb-6">âœ‰ï¸</div>
            <h2 class="text-2xl font-bold mb-4">å¦³çš„éƒ¨åˆ†å·²å®Œæˆï¼</h2>
            <p class="text-gray-500 mb-8 text-sm leading-relaxed">è«‹è¤‡è£½é€£çµå‚³çµ¦ç”·å‹ï¼Œ<br>ç•¶ä»–å¯«å®Œï¼Œä½ å€‘å°±èƒ½çœ‹åˆ°å½¼æ­¤çš„é»˜å¥‘å ±å‘Šã€‚</p>
            <button onclick="copyLink()" class="w-full py-4 btn-primary rounded-2xl font-bold shadow-lg">è¤‡è£½é€£çµå‚³çµ¦ä»–</button>
            <input id="share-url-hidden" type="text" class="absolute -top-full left-0 opacity-0">
        </div>

        <div id="result-screen" class="hidden">
            <div id="capture-area" class="bg-white p-4 rounded-2xl">
                <div class="text-center mb-6">
                    <h2 class="text-xl font-bold text-gray-800">æˆ‘å€‘çš„ç”Ÿæ´»å…±è­˜å ±å‘Š</h2>
                    <p class="text-[9px] text-[#5F8575] uppercase tracking-widest mt-1">CreatedAt: 2026 / Danshui New Home</p>
                </div>
                <div id="result-list" class="space-y-4 max-h-[50vh] overflow-y-auto pr-1"></div>
            </div>
            
            <div class="mt-8 space-y-3">
                <button onclick="downloadImage()" class="w-full py-4 bg-[#5F8575] text-white rounded-2xl font-bold shadow-md flex items-center justify-center">
                    <span class="mr-2">ğŸ“¸</span> å„²å­˜çµæœåœ–
                </button>
                <button onclick="location.href=window.location.pathname" class="w-full py-2 text-[10px] text-gray-300 underline uppercase tracking-widest">Restart</button>
            </div>
        </div>
    </div>

    <script>
        // âœï¸ é¡Œå‹ï¼štype å¯è¨­ç‚º 'choice' (é¸æ“‡) æˆ– 'input' (å¡«ç©º)
        const questions = [
    // ğŸ’° ç¬¬ä¸€éƒ¨åˆ†ï¼šé‡‘éŒ¢è§€èˆ‡è²¡å‹™åˆ†é…
    { 
        q: "æˆ¿ç§Ÿã€æ°´é›»é›œè²»ç­‰åŸºç¤é–‹éŠ·ï¼Œæˆ‘å€‘æ€éº¼åˆ†æ“”ï¼Ÿ", 
        options: ["çµ•å°å…¬å¹³ 50/50 åˆ†æ”¤", "æŒ‰é›™æ–¹è–ªè³‡æ¯”ä¾‹åˆ†æ“”", "ä¸€äººè² è²¬æˆ¿ç§Ÿï¼Œå¦ä¸€äººè² è²¬é›œæ”¯", "æˆ‘å°é‡‘éŒ¢æ²’æ¦‚å¿µï¼Œä½ æ±ºå®šå°±å¥½"], 
        type: "choice" 
    },
    { 
        q: "é—œæ–¼å…±åŒåŸºé‡‘ï¼ˆå…¬ç©é‡‘ï¼‰ï¼Œå¦³/ä½ çš„æƒ³æ³•æ˜¯ï¼Ÿ", 
        options: ["æ”¯æŒï¼æ¯æœˆå„å­˜å…¥å›ºå®šé‡‘é¡æ”¯ä»˜å…¬ç”¨", "ä¸ç”¨ç‰¹åˆ¥è¨­å¸³æˆ¶ï¼Œå…ˆä»˜çš„äººå†è«‹æ¬¾", "ç”±å…¶ä¸­ä¸€äººå…ˆå¢Šï¼Œæœˆåº•å†ä¸€æ¬¡çµç®—", "ä¸æƒ³åˆ†å¤ªç´°ï¼Œéš¨æ€§å°±å¥½"], 
        type: "choice" 
    },
    { 
        q: "åœ¨ã€Œçœé›»ã€èˆ‡ã€Œç”Ÿæ´»å“è³ªã€ä¹‹é–“ï¼Œå¦³çš„å¹³è¡¡é»åœ¨å“ªï¼Ÿ", 
        options: ["çœé›»è‡³ä¸Šï¼éš¨æ‰‹é—œç‡ˆï¼Œå†·æ°£å®šæ™‚", "èˆ’é©è‡³ä¸Šï¼å†·æ°£é–‹æ•´æ™šï¼Œè©²ç”¨å°±ç”¨", "æŠ˜è¡·æ´¾ï¼šäººåœ¨æ‰é–‹ï¼Œé›¢é–‹å¿…é—œ", "å®Œå…¨æ²’æ„è¦‹"], 
        type: "choice" 
    },
    { 
        q: "è³¼è²·æ—¥ç”¨å“æ™‚ï¼Œå¦³æ›´å‚¾å‘å“ªç¨®æ¶ˆè²»ç¿’æ…£ï¼Ÿ", 
        options: ["åƒ¹æ ¼å°å‘ï¼šç‰¹åƒ¹ã€CPå€¼æœ€é«˜å„ªå…ˆ", "å“è³ªå°å‘ï¼šå“ç‰Œèˆ‡æˆåˆ†æ¯”åƒ¹æ ¼é‡è¦", "ç’°ä¿å°å‘ï¼šå„ªå…ˆé¸æ“‡ç’°å¢ƒå‹å–„ç”¢å“", "çœ‹å¿ƒæƒ…ï¼Œæ²’æœ‰å›ºå®šæ¨™æº–"], 
        type: "choice" 
    },
    { 
        q: "é—œæ–¼ã€Œå¤–é£Ÿã€èˆ‡ã€Œä¸‹å»šã€çš„é–‹éŠ·åˆ†é…ï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šä¸‹å»šç”¨å…±åŒåŸºé‡‘ï¼Œå¤–é£Ÿå‰‡å„ä»˜å„çš„..." 
    },

    // ğŸ§¹ ç¬¬äºŒéƒ¨åˆ†ï¼šå®¶äº‹åˆ†å·¥èˆ‡ç”Ÿæ´»æ•´æ½”åº¦
    { 
        q: "å®¶äº‹å¤§é»åï¼å¦³æœ€ä¸æ’æ–¥å“ªå¹¾é …ï¼Ÿï¼ˆå‰©ä¸‹çš„æˆ‘å€‘å†åˆ†ï¼‰", 
        type: "input", 
        placeholder: "åˆ—å‡ºå¦³é¡˜æ„åšçš„ï¼šå¦‚æ´—ç¢—ã€å€’åƒåœ¾ã€æƒåœ°ã€æ´—å»æ‰€..." 
    },
    { 
        q: "å¦³å°ã€Œé›œç‰©äº‚ä¸Ÿã€çš„å®¹å¿åº¦æ˜¯ï¼Ÿï¼ˆå¦‚è¡£æœå †æ¤…å­ï¼‰", 
        options: ["çµ•å°ä¸è¡Œï¼Œæ¯å¤©éƒ½è¦æ”¶ä¹¾æ·¨", "å¯ä»¥æ”¾å€‹2-3å¤©ï¼Œé€±æœ«å†æ”¶", "åªè¦ä¸å½±éŸ¿èµ°è·¯ï¼Œæˆ‘éƒ½èƒ½å¿å—", "æˆ‘æ˜¯äº‚ä¸Ÿçš„é‚£å€‹äºº"], 
        type: "choice" 
    },
    { 
        q: "æ´—å®Œæ¾¡å¾Œï¼Œå°æ–¼ã€Œæµ´å®¤åœ°æ¿ã€çš„å…±è­˜æ˜¯ï¼Ÿ", 
        options: ["ä¸€å®šè¦æ‹¿åˆ®åˆ€æˆ–æ‹–æŠŠæ“¦ä¹¾åœ°æ¿èˆ‡ç‰†å£", "ç°¡å–®æ¸…ç†æ¯›é«®å³å¯ï¼Œåœ°æ¿è‡ªç„¶ä¹¾", "æ²’æ„Ÿè¦ºï¼Œéš¨ä¾¿å®ƒ", "å¸Œæœ›æœ‰ä¹¾æ¿•åˆ†é›¢ï¼Œä¸ç„¶æœƒå´©æ½°"], 
        type: "choice" 
    },
    { 
        q: "æ°´æ§½è£¡çš„é«’ç¢—ç›¤å¯ä»¥ç•™å¤šä¹…ï¼Ÿ", 
        options: ["åƒå®Œé¦¬ä¸Šæ´—ï¼Œæ°´æ§½å¿…é ˆä¿æŒæ·¨ç©º", "ç¡è¦ºå‰æ´—å®Œå°±å¥½", "éš”å¤©æ—©ä¸Šå†èªª", "ç©æ»¿ä¸€æ•´æ¡¶å†ä¸€èµ·è™•ç†"], 
        type: "choice" 
    },
    { 
        q: "é—œæ–¼æ´—è¡£æœçš„ã€Œç´°ç¯€ã€ç¿’æ…£ï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šè¥ªå­å¿…é ˆåˆ†é–‹æ´—ã€ä¸å–œæ­¡çƒ˜è¡£æ©Ÿ..." 
    },

    // ğŸ•°ï¸ ç¬¬ä¸‰éƒ¨åˆ†ï¼šç”Ÿæ´»ä½œæ¯èˆ‡å€‹äººç©ºé–“
    { 
        q: "ç•¶ä½œæ¯ä¸ä¸€è‡´æ™‚ï¼ˆæ—©èµ·vsæ™šç¡ï¼‰ï¼Œå¦³å¸Œæœ›å°æ–¹æ€éº¼åšï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šæ™šç¡è€…ä¸å‡†é–‹å¤§ç‡ˆã€èµ°è·¯è¦è¼•è²..." 
    },
    { 
        q: "ç•¶æˆ‘å‡ºç¾å“ªäº›è¡Œç‚ºæ™‚ï¼Œä»£è¡¨æˆ‘éœ€è¦ã€ŒMe Timeã€ä¸è¦æ‰“æ“¾ï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šæˆ´è€³æ©Ÿã€é€²æˆ¿é—œé–€ã€æˆ–ç›´æ¥èªªæˆ‘è¦å®‰éœ..." 
    },
    { 
        q: "æˆ‘å€‘æ˜¯å¦éœ€è¦ä¿ç•™ã€Œå„è‡ªç¤¾äº¤ã€çš„æ™‚é–“ï¼Ÿ", 
        options: ["å¼·çƒˆéœ€è¦ï¼Œæ¯é€±è‡³å°‘ä¸€æ™šçµ¦æœ‹å‹æˆ–èˆˆè¶£", "ä¸éœ€è¦ï¼Œæƒ³åšä»€éº¼éƒ½ä¸€èµ·", "éš¨èˆˆå°±å¥½ï¼Œä¸ç”¨ç‰¹åˆ¥è¦å®š", "å¸Œæœ›ç¤¾äº¤æ´»å‹•ä¹Ÿèƒ½å¸¶è‘—å°æ–¹"], 
        type: "choice" 
    },
    { 
        q: "å¦‚æœé›™æ–¹éƒ½åœ¨å®¶å·¥ä½œï¼ˆWFHï¼‰ï¼Œå¦³æœƒå¸Œæœ›å¦‚ä½•åˆ†é…å€åŸŸï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šä¸€äººåœ¨æˆ¿é–“ä¸€äººåœ¨å®¢å»³ã€è¦–è¨Šæ™‚è¦é¿é–‹..." 
    },

    // ğŸ‘¥ ç¬¬å››éƒ¨åˆ†ï¼šç¤¾äº¤ç•Œé™èˆ‡è¦ªå‹å¾€ä¾†
    { 
        q: "æœ‹å‹æƒ³ä¾†å®¶è£¡ç©ï¼Œéœ€è¦æå‰å¤šä¹…å‘ŠçŸ¥ï¼Ÿ", 
        options: ["è‡³å°‘ä¸€å¤©å‰ï¼Œè¦å…ˆè¨è«–", "ä¸€å°æ™‚å‰èªªä¸€è²å°±å¥½", "éš¨æ™‚æ­¡è¿ï¼Œä¸ç”¨å ±å‚™", "å®¶æ˜¯ç¦åœ°ï¼Œå„˜é‡ä¸è¦å¸¶äººå›ä¾†"], 
        type: "choice" 
    },
    { 
        q: "é—œæ–¼ã€Œæœ‹å‹ç•™å®¿ã€çš„é »ç‡èˆ‡è¦å®šï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šåƒ…é™åŒæ€§ã€æ¯å€‹æœˆä¸èƒ½è¶…éå…©æ¬¡..." 
    },
    { 
        q: "å®¶é•·æˆ–è¦ªæˆšè¦ä¾†è¨ªï¼Œå¦³çš„åº•ç·šèˆ‡æœŸæœ›æ˜¯ï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šä¸èƒ½çµ¦é‘°åŒ™ã€å¦ä¸€åŠä¸ä¸€å®šè¦å…¨ç¨‹é™ªåŒ..." 
    },

    // ğŸ«‚ ç¬¬äº”éƒ¨åˆ†ï¼šè¡çªè§£æ±ºèˆ‡æƒ…æ„Ÿç¶­è­·
    { 
        q: "åµæ¶æ™‚çš„ã€Œå’Œè§£å”è­°ã€ï¼Ÿï¼ˆå†·éœæœŸé™åˆ¶ï¼‰", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šå¯ä»¥ç”Ÿæ°£ä½†ä¸èƒ½æ‘”é–€ã€æœ€ä¹…å…©å°æ™‚å…§è¦å°è©±..." 
    },
    { 
        q: "é—œæ–¼ã€ŒåŒå±…å¾Œçš„å„€å¼æ„Ÿã€ï¼Œå¦³æœ€çœ‹é‡ä»€éº¼ï¼Ÿ", 
        options: ["æ¯é€±å›ºå®šçš„æ­£å¼ç´„æœƒæ—¥", "å‡ºé–€å‰èˆ‡ç¡å‰çš„è¦ªè¦ªæŠ±æŠ±", "æ¯å¤©ä¸€èµ·åƒä¸€é “é£¯ä¸¦èŠå¤©", "æ²’èˆˆè¶£ï¼Œç”Ÿæ´»ç°¡å–®å¹³æ·¡å°±å¥½"], 
        type: "choice" 
    },
    { 
        q: "ï¼ˆæˆç†Ÿé¡Œï¼‰è‹¥æœªä¾†ç™¼ç¾çœŸçš„ä¸é©åˆï¼Œé€€å ´æ©Ÿåˆ¶æ˜¯ï¼Ÿ", 
        type: "input", 
        placeholder: "ä¾‹å¦‚ï¼šæŠ¼é‡‘æ€éº¼åˆ†ã€å¤§å‹å®¶å…·æ­¸èª°ã€çµ¦å½¼æ­¤å¤šä¹…æ¬å®¶æœŸ..." 
    }
];

        let partnerAnswers = null;
        let myAnswers = [];
        let currentQ = 0;

        window.onload = () => {
            const urlParams = new URLSearchParams(window.location.search);
            const data = urlParams.get('ans');
            if (data) {
                // è§£ç¢¼ Base64 ä»¥æ”¯æ´ä¸­æ–‡
                partnerAnswers = JSON.parse(decodeURIComponent(escape(window.atob(data))));
            }
        };

        function startQuiz() {
            document.getElementById('start-screen').classList.add('hidden');
            document.getElementById('quiz-screen').classList.remove('hidden');
            showQuestion();
        }

        function showQuestion() {
            const q = questions[currentQ];
            const progress = ((currentQ + 1) / questions.length) * 100;
            document.getElementById('progress-text').innerText = `QUESTION ${currentQ + 1} / ${questions.length}`;
            document.getElementById('progress-inner').style.width = `${progress}%`;
            document.getElementById('question-text').innerText = q.q;
            
            const optionsDiv = document.getElementById('options');
            const inputArea = document.getElementById('custom-input-area');
            optionsDiv.innerHTML = '';
            
            if (q.type === 'choice') {
                inputArea.classList.add('hidden');
                q.options.forEach((opt, index) => {
                    const btn = document.createElement('button');
                    btn.className = "w-full text-left p-4 rounded-xl btn-option text-sm";
                    btn.innerText = opt;
                    btn.onclick = () => saveAnswer(opt);
                    optionsDiv.appendChild(btn);
                });
            } else {
                inputArea.classList.remove('hidden');
                document.getElementById('custom-text').value = '';
                document.getElementById('custom-text').placeholder = q.placeholder;
            }
        }

        function handleCustomSubmit() {
            const val = document.getElementById('custom-text').value.trim();
            if (!val) return alert("è«‹è¼¸å…¥å…§å®¹å–”ï½");
            saveAnswer(val);
        }

        function saveAnswer(answer) {
            myAnswers.push(answer);
            if (currentQ < questions.length - 1) {
                currentQ++;
                showQuestion();
            } else {
                finishQuiz();
            }
        }

        function finishQuiz() {
            document.getElementById('quiz-screen').classList.add('hidden');
            if (partnerAnswers) {
                showResult();
            } else {
                // ä½¿ç”¨ Base64 ç·¨ç¢¼æ”¯æ´ä¸­æ–‡å‚³è¼¸
                const ansString = window.btoa(unescape(encodeURIComponent(JSON.stringify(myAnswers))));
                const shareUrl = window.location.origin + window.location.pathname + '?ans=' + ansString;
                document.getElementById('share-url-hidden').value = shareUrl;
                document.getElementById('share-screen').classList.remove('hidden');
            }
        }

        function showResult() {
            document.getElementById('result-screen').classList.remove('hidden');
            const resultList = document.getElementById('result-list');
            questions.forEach((q, i) => {
                const isMatch = myAnswers[i] === partnerAnswers[i];
                const item = document.createElement('div');
                item.className = `p-4 rounded-2xl mb-3 border ${isMatch ? 'border-green-100 bg-green-50' : 'border-orange-100 bg-orange-50'}`;
                item.innerHTML = `
                    <p class="font-bold text-[11px] mb-2 text-gray-700">${i+1}. ${q.q}</p>
                    <div class="grid grid-cols-2 gap-2 text-[10px] leading-relaxed">
                        <div class="bg-white/80 p-2 rounded-lg">ğŸ‘§ï¼š${myAnswers[i]}</div>
                        <div class="bg-white/80 p-2 rounded-lg">ğŸ‘¦ï¼š${partnerAnswers[i]}</div>
                    </div>
                `;
                resultList.appendChild(item);
            });
        }

        function downloadImage() {
            const area = document.getElementById('capture-area');
            html2canvas(area, { 
                backgroundColor: "#FFFFFF",
                scale: 2 // æé«˜æ¸…æ™°åº¦
            }).then(canvas => {
                const link = document.createElement('a');
                link.download = `Our_Home_Manifesto.png`;
                link.href = canvas.toDataURL();
                link.click();
            });
        }

        function copyLink() {
            const copyText = document.getElementById("share-url-hidden");
            copyText.select();
            document.execCommand("copy");
            alert("é€£çµå·²è¤‡è£½ï¼å‚³çµ¦ç”·å‹å¾Œï¼Œç­‰ä»–ä¹Ÿå¯«å®Œå°±èƒ½çœ‹çµæœå›‰ï½");
        }
    </script>
</body>
</html>
